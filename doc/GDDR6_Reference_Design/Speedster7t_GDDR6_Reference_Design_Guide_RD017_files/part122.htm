<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Testbench Sequence</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part121.htm">&lt; Previous</a><span> | </span><a href="../Speedster7t_GDDR6_Reference_Design_Guide_RD017.html">Contents</a><span> | </span><a href="part123.htm">Next &gt;</a></p><p class="s9" style="padding-top: 14pt;padding-left: 11pt;text-indent: 0pt;text-align: left;"><a name="bookmark127">&zwnj;</a>Testbench Sequence</p><p style="padding-top: 7pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">When using the simulation command file, it is important to ensure that it is applied in the right sequence to correspond to when it would be executed in hardware.</p><p style="padding-top: 6pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">The runtime programming script is executed when the device is in user mode. This follows the configuration mode when the bitstream is loaded into the interface subsystems and the fabric. The mode is indicated by</p><p style="text-indent: 0pt;text-align: left;"><span><img width="168" height="21" alt="image" src="Image_719.png"/></span></p><p class="s8" style="padding-top: 3pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">FCU_CONFIG_USER_MODE</p><p class="s8" style="padding-top: 3pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">FCU_CONFIG_USER_MODE</p><p style="text-indent: 0pt;text-align: left;"/><p class="s8" style="padding-top: 3pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">FCU_CONFIG_USER_MODE</p><p style="padding-top: 3pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">the               pin on a Speedster7t device. Execution of the simulation command file should</p><p style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;line-height: 11pt;text-align: left;">only occur when this signal has been asserted. For full details of the configuration pins and programming modes,</p><p class="s6" style="padding-left: 11pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><a href="https://www.achronix.com/documentation/speedster7t-configuration-user-guide-ug094" class="a" target="_blank">see the </a><a href="https://www.achronix.com/documentation/speedster7t-configuration-user-guide-ug094" class="s4" target="_blank">Speedster7t Configuration User Guide </a>(UG094)<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="658" height="255" alt="image" src="Image_720.png"/></span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">// Create signal to indicate device configuration state</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;line-height: 118%;text-align: left;">// When set, device is in user mode logic chip_ready;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">// Instantiate the DSM model, (device dependant)</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">`ACX_DEVICE_NAME `ACX_DEVICE_NAME (</p><p class="s27" style="padding-top: 1pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">.FCU_CONFIG_USER_MODE (chip_ready)</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;line-height: 118%;text-align: left;">// Programming sequence initial</p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;line-height: 10pt;text-align: left;">begin</p><p class="s27" style="padding-top: 1pt;padding-left: 31pt;text-indent: 0pt;line-height: 10pt;text-align: left;">// Device configuration phase. Use ACE generated configurations</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">// Create signal to indicate device configuration state</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;line-height: 118%;text-align: left;">// When set, device is in user mode logic chip_ready;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">// Instantiate the DSM model, (device dependant)</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">`ACX_DEVICE_NAME `ACX_DEVICE_NAME (</p><p class="s27" style="padding-top: 1pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">.FCU_CONFIG_USER_MODE (chip_ready)</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;line-height: 118%;text-align: left;">// Programming sequence initial</p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;line-height: 10pt;text-align: left;">begin</p><p class="s27" style="padding-top: 1pt;padding-left: 31pt;text-indent: 0pt;line-height: 10pt;text-align: left;">// Device configuration phase. Use ACE generated configurations</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">// Create signal to indicate device configuration state</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;line-height: 118%;text-align: left;">// When set, device is in user mode logic chip_ready;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">// Instantiate the DSM model, (device dependant)</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">`ACX_DEVICE_NAME `ACX_DEVICE_NAME (</p><p class="s27" style="padding-top: 1pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">.FCU_CONFIG_USER_MODE (chip_ready)</p><p class="s27" style="padding-top: 1pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;line-height: 118%;text-align: left;">// Programming sequence initial</p><p class="s27" style="padding-left: 10pt;text-indent: 0pt;line-height: 10pt;text-align: left;">begin</p><p class="s27" style="padding-top: 1pt;padding-left: 31pt;text-indent: 0pt;line-height: 10pt;text-align: left;">// Device configuration phase. Use ACE generated configurations</p><p style="padding-top: 6pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">An example sequence, showing the connections to the DSM model, the device configuration, and the runtime programming sequence follows.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 11pt;text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="658" height="271" alt="image" src="Image_721.png"/></span></p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// These configurations perform the same function as loading the bitstream</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">`include &quot;../../src/ioring/&lt;design name&gt;_sim_config.svh&quot;</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// These configurations perform the same function as loading the bitstream</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">`include &quot;../../src/ioring/&lt;design name&gt;_sim_config.svh&quot;</p><p style="text-indent: 0pt;text-align: left;"/><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// These configurations perform the same function as loading the bitstream</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">`include &quot;../../src/ioring/&lt;design name&gt;_sim_config.svh&quot;</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 118%;text-align: left;">// Wait for device to enter user mode while ( chip_ready !== 1&#39;b1 )</p><p class="s27" style="padding-left: 21pt;text-indent: 0pt;line-height: 10pt;text-align: left;">@(posedge clk);</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="text-indent: 0pt;text-align: left;">// Device now in user mode</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// Execute simulation command file to perform runtime programming</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">`ACX_DEVICE_NAME.fcu.configure( &quot;../&lt;simulation command file&gt;.txt&quot;, &quot;full&quot;);</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 118%;text-align: left;">// Wait for device to enter user mode while ( chip_ready !== 1&#39;b1 )</p><p class="s27" style="padding-left: 21pt;text-indent: 0pt;line-height: 10pt;text-align: left;">@(posedge clk);</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="text-indent: 0pt;text-align: left;">// Device now in user mode</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// Execute simulation command file to perform runtime programming</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">`ACX_DEVICE_NAME.fcu.configure( &quot;../&lt;simulation command file&gt;.txt&quot;, &quot;full&quot;);</p><p style="text-indent: 0pt;text-align: left;"/><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 118%;text-align: left;">// Wait for device to enter user mode while ( chip_ready !== 1&#39;b1 )</p><p class="s27" style="padding-left: 21pt;text-indent: 0pt;line-height: 10pt;text-align: left;">@(posedge clk);</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="text-indent: 0pt;text-align: left;">// Device now in user mode</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// Execute simulation command file to perform runtime programming</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">`ACX_DEVICE_NAME.fcu.configure( &quot;../&lt;simulation command file&gt;.txt&quot;, &quot;full&quot;);</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// When simulation command file completes, test is done</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">$finish</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// When simulation command file completes, test is done</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">$finish</p><p style="text-indent: 0pt;text-align: left;"/><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">// When simulation command file completes, test is done</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">$finish</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">end</p><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">end</p><p style="text-indent: 0pt;text-align: left;"/><p class="s27" style="padding-top: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">end</p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part121.htm">&lt; Previous</a><span> | </span><a href="../Speedster7t_GDDR6_Reference_Design_Guide_RD017.html">Contents</a><span> | </span><a href="part123.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
